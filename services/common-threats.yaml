threats:
  - id: CCC.TH01 # Unauthorized access through elevated privileges
    title: Unauthorized access through elevated privileges
    description: |
      An attacker can exploit misconfigured access controls to gain
      unauthorized access to sensitive resources by granting excessive privileges.
    features:
      - CCC.F06 # Identity Based Access Control
    mitre_attack:
      - T1078 # Valid Accounts
      - T1548 # Abuse Elevation Control Mechanism
      - T1203 # Exploitation for Credential Access
      - T1098 # Account Manipulation
      - T1484 # Domain or Tenant Policy Modification
      - T1546 # Event Triggered Execution

  - id: CCC.TH02 # Vendor-hosted keys are compromised
    title: Vendor-hosted keys are compromised
    description: |
      The service uses a vendor-hosted key management service (KMS) to manage
      encryption keys. Insider threats or mistakes can result in access by a
      threat actor.
    features:
      - CCC.F02 # Encryption at Rest Enabled by Default
    mitre_attack:
      - T1556 # Modify Authentication Process
      - T1098.001 # Account Manipulation: Additional Cloud Credentials
      - T1078.004 # Valid Accounts: Cloud Accounts

  - id: CCC.TH03 # Attacker intercepts data in transit
    title: Attacker intercepts data in transit
    description: |
      In the event that encrypted communication is not properly in effect, an
      attacker can intercept traffic between clients and the service to read or
      modify the data during transmission.
    features:
      - CCC.F01 # Encryption in Transit Enabled by Default
    mitre_attack:
      - T1557 # Adversary-in-the-Middle
      - T1040 # Network Sniffing

  - id: CCC.TH05 # Actors in known dangerous regions intercept network activity
    title: Actors in known dangerous regions intercept network activity
    description: |
      If the service is deployed in a region with known geopolitical risks, an
      attacker in that region may attempt to access the resource by exploiting
      privileged network access or other vulnerabilities.
    features:
      - CCC.F08 # Multi-zone Deployability
    mitre_attack:
      - T1583 # Acquire Infrastructure
      - T1040 # Network Sniffing

  - id: CCC.TH06 # Resource exhaustion
    title: Resource exhaustion
    description: |
      An attack or misconfiguration can consume all available resources, such
      as memory, CPU, or storage, to disrupt the service or deny access to 
      legitimate users. This can be achieved through repeated requests,
      resource-intensive operations, or the lowering of rate/budget limits.
      Through auto-scaling, the attacker may also attempt to exhaust
      higher-level budget thresholds to impact other systems in the same scope.
    features:
      - CCC.F04 # Transaction Rate Limits
      - CCC.F16 # Budgeting
    mitre_attack:
      - T1496 # Resource Hijacking
      - T1499 # Endpoint Denial of Service
      - T1498 # Network Denial of Service

  - id: CCC.TH07 # Abuse of event notifications
    title: Abuse of event notifications
    description: |
      Malicious actors may exploit event notifications to monitor and
      intercept information about sensitive operations or access patterns. 
      Alternately, attackers may flood the system with notifications to
      obfuscate another attack or overwhelm the service to disrupt 
      legitimate operations.
    features:
      - CCC.F07 # Event Notifications
      - CCC.F09 # Monitoring
    mitre_technique:
      - T1057 # Process Discovery

  - id: CCC.TH08 # Data corruption during replication
    title: Data corruption during replication
    description: |
      Malicious actors may attempt to corrupt, delay, or delete data during
      replication processes across multiple regions or availability zones,
      affecting the integrity and availability of data.
    features:
      - CCC.F09 # Backup
      - CCC.F11 # Recovery
      - CCC.F21 # Replication
      - CCC.F12 # Recovery
    mitre_technique:
      - T1485 # Data Destruction
      - T1565 # Data Manipulation
      - T1491 # Defacement
      - T1490 # Inhibit System Recovery

  - id: CCC.TH10
    title: Unauthorized resource replication to untrusted or external locations
    description: |
      An attacker could replicate objects to untrusted or external locations if replication configurations 
      are not properly restricted. This could result in data leakage or exposure to unauthorized entities 
      outside the organization's trusted perimeter.
    features:
      - CCC.F05
    mitre_attack: # TODO
      - T1565 # Data Manipulation

  - id: CCC.TH11
    title: Data is lost or corrupted
    description: |
      Data loss or corruption can occur due to accidental deletion,
      misconfiguration, or malicious activity.  This can result in the loss of
      critical data, service disruption, or unauthorized access to sensitive
      information.
    features: []
    mitre_attack:
      - T1485 # Data Destruction
      - T1565 # Data Manipulation
      - T1491 # Defacement
      - T1490 # Inhibit System Recovery